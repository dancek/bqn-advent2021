in â† â€¢FLines "12.txt"
edges â† '-'{(ğ•©âŠğ•¨)(â†‘â‹ˆ1â†“â†“)ğ•©}Â¨in
nodes â† â·âˆ¨âˆ¾edges
len â† â‰ nodes
Idx â† âŠ‘nodesâŠ<

# upper-case nodes are revisitable
revisitable â† 'Z'â‰¥âŠ‘Â¨nodes

# create adjacency matrix
adj â† (â‹ˆËœlen)â¥Š0
{ğ•Š aâ€¿b:
  adj â†©  adj + â‰âŠ¸+((Idx a)=â†•len)âˆ§âŒœ(Idx b)=â†•len
}Â¨edges

# sum with recursive DFS
PathCount â† {visitedâ€¿revisit ğ•Š node:
  node â‰  Idx "end" ?
    ns â† / (Â¬visited) âˆ§ nodeâŠadj
    rs â† / (Â¬"start"âŠ¸â‰¡Â¨nodes) âˆ§ revisit âˆ§ visited âˆ§ nodeâŠadj
    v â† { nodeâŠ‘revisitable ? visited ; visited âˆ¨ node=â†•len }
    +Â´ ((vâ€¿0)âŠ¸PathCountÂ¨rs) âˆ¾ (vâ€¿revisit)âŠ¸PathCountÂ¨ns
  ; 1
}

â€¢Show (lenâ¥Š0)â€¿0 PathCount (Idx "start")
â€¢Show (lenâ¥Š0)â€¿1 PathCount (Idx "start")
