lines â† âŸ¨
  "00100"
  "11110"
  "10110"
  "10111"
  "10101"
  "01111"
  "00111"
  "11100"
  "10000"
  "11001"
  "00010"
  "01010"
âŸ©
lines â†© â€¢FLines "03.txt"
bs â† >'0'-ËœË˜lines
halflen â† 2Ã·Ëœâ‰ bs
bitcounts â† +Ëbs
gammab â† halflen < bitcounts
epsilonb â† 1-gammab

Bits_to_int â† {+Â´(2â‹†â†•â‰ ğ•©) Ã— âŒ½ğ•©}

â€¢Show (Bits_to_int gammab) Ã— (Bits_to_int epsilonb)

While   â† {ğ•©{ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}ğ•¨@}Â´

_getfn â† {
  F â† ğ”½
  i â† 0
  xs â† ğ•©
  While {ğ•¤ â‹„ 1 < â‰ xs}â€¿{ğ•¤
    limit â† 2Ã·Ëœâ‰ xs
    bit â† limit F +Â´iâŠ‘Ë˜xs

    matching â† bit = iâŠË˜xs
    xs â†© matching / xs
    i â†© i+1
  }
  Bits_to_int â¥Š xs
}

Get_O2 â† â‰¥ _getfn
Get_CO2 â† < _getfn
â€¢Show (Get_CO2 bs) Ã— Get_O2 bs
